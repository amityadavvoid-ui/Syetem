## 2026-02-28 - Centralized requestAnimationFrame loops for particle effects
**Learning:** Found a major anti-pattern in `ui.js` where `spawnParticle()` invoked its own individual closures and `requestAnimationFrame` loops per particle. In systems with frequent visual updates and caps (up to 25 particles in this system), spawning separated `rAF` callbacks adds substantial function overhead and harms browser style rendering and batching.
**Action:** Always prefer to keep single, centralized loops (e.g. `updateParticlesLoop`) that iterate through arrays of state objects. Only store pure configuration metadata (like maxOpacity, duration, startTime) instead of DOM elements themselves in the overarching app state if possible, and manage batched DOM updates centrally to keep micro-optimizations performant and lightweight.